(function(){function o(){var t=document.getElementById("inputscale"),n;(document.getElementById("scale").innerHTML=t.value,n=document.getElementById("svggraph"),n!==null&&width!==0)&&(n.style.width=(width*t.value/100).toString()+"px",n.style.height=(height*t.value/100).toString()+"px")}function s(){document.getElementById("ref").classList.add("hidden");document.getElementById("spinner2").classList.remove("hidden");document.getElementById("outtext").innerHTML="<p><br />Searching......<br /><br />If the query is too big, the search may take a long time.<\/p><br />"}function h(n){var u=document.getElementById("outtext"),t,i,r;if(n.length===0){u.innerHTML="No data found.";return}t=['<table class="table table-responsive"><thead><tr><th>Upstream<\/th><th>Downstream<\/th><th>Reference<\/th><\/tr><\/thead><tbody>'];for(let u=0;u<n.length;u++){t.push("<tr>");t.push('<td><a href="https://www.ncbi.nlm.nih.gov/gene/'+n[u].gene1+'" target="_blank">'+n[u].geneName1+"<\/a><\/td>");t.push('<td><a href="https://www.ncbi.nlm.nih.gov/gene/'+n[u].gene2+'" target="_blank">'+n[u].geneName2+"<\/a><\/td>");i=[];for(let t=0;t<n[u].references.length;t++)i.push('<a href="https://www.ncbi.nlm.nih.gov/pubmed/'+n[u].references[t].refID+'" target="_blank">'+n[u].references[t].author+"<\/a>");r=i.join(", ");t.push('<td scope="row">'+r+"<\/td>");t.push("<\/tr>")}t.push("<\/tbody><\/table>");document.getElementById("outtext").innerHTML=t.join("")}function c(){var f,n,r;if(u(),v(),t||i){alert('For MS IE and Edge browsers, please right-click on the picture and choose "Save Picture As".');return}f=document.getElementById("svggraph");n=document.createElement("svg");n.setAttribute("version","1.1");n.setAttribute("xmlns","http://www.w3.org/2000/svg");n.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");n.setAttribute("x","0px");n.setAttribute("y","0px");n.setAttribute("viewBox","0 0 "+parseFloat(f.style.width).toFixed(1)+" "+parseFloat(f.style.height).toFixed(1));n.setAttribute("xml:space","preserve");n.innerHTML=f.innerHTML;r=document.createElement("a");r.setAttribute("href","data:image/svg+xml;utf8,"+n.outerHTML);r.setAttribute("download","graph.svg");r.style.display="none";r.setAttribute("target","_blank");document.getElementById("outtext").appendChild(r);r.click();document.getElementById("outtext").removeChild(r)}function l(){document.getElementById("btnsubmit").disabled=!0;document.getElementById("spinner").classList.remove("hidden");document.getElementById("ref").classList.add("hidden");document.getElementById("div-scale").classList.add("hidden");document.getElementById("prompt").innerHTML="";document.getElementById("outtext").innerHTML="";document.getElementById("spinner").innerHTML=document.getElementById("spinner").innerHTML;document.getElementById("output").innerHTML="<p><br />Searching......<br /><br />If the query is too big, the search may take a long time.<\/p><br />"}function r(n){document.getElementById("div-scale").classList.add("hidden");document.getElementById("prompt").innerHTML="";document.getElementById("output").innerHTML="<br /><p>"+n+"<\/p>";document.getElementById("outtext").innerHTML=""}function n(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function a(n){return n.status===2?(r("The figure is too large to render. Try to reduce length and number limits of your search"),[0,0,[]]):n.status===1?(r("No data was found. The gene may not exist or may not be involved in any interactions recorded."),[0,0,[]]):(document.getElementById("ref").classList.remove("hidden"),document.getElementById("div-scale").classList.add("hidden"),document.getElementById("prompt").innerHTML="The search prioritises genes that have been reported more.<br />        Line Widths are proportional to numbers of academic reports.",y(n))}function u(){if(t===null){var n=window.navigator.userAgent,i=n.indexOf("MSIE ");t=n.indexOf("MSIE")>0||n.indexOf("Trident")>0?!0:!1}}function v(){i===null&&(i=window.navigator.userAgent.indexOf("Edge")>0?!0:!1)}function y(t){var u=100,o=u/3.5,st=t.xmax*u+u,ht=t.ymax*u+u,ut={},e,l,i,h,at,rt,k,p,d,vt,y,yt,w,c,g;document.getElementById("output").innerHTML='<svg id="svggraph" class="mx-auto d-block">Sorry, your browser does not support inline SVG. Recommend using the newest version of Chrome.<\/svg >';e=document.getElementById("svggraph");l=["0","0",st.toString(),ht.toString()];e.setAttribute("viewBox",l.join(" "));e.setAttribute("width",st.toString());e.setAttribute("height",ht.toString());var r=t.vertex,a=t.edge,s=null;for(i=0;i<a.length;i++)if(a[i][0]!==null&&a[i][1]!==null){var ft=r[a[i][0]][1]*u,nt=r[a[i][1]][1]*u,et=r[a[i][0]][2]*u,tt=r[a[i][1]][2]*u;lineWidth=Math.abs(a[i][2]);lineWidth>15&&(lineWidth=15);var v=6+lineWidth/4,it=3+lineWidth*.7,ct=Math.sqrt(Math.pow(nt-ft,2)+Math.pow(tt-et,2)),f=[(nt-ft)/ct,(tt-et)/ct],b=[nt-f[0]*o*1.1,tt-f[1]*o*1.1],lt=[nt-f[0]*(o+v*1.5),tt-f[1]*(o+v*1.5)];s=n("g");h=n("line");h.setAttribute("x1",f[0]*(o+v)+ft);h.setAttribute("y1",f[1]*(o+v)+et);h.setAttribute("x2",lt[0]);h.setAttribute("y2",lt[1]);h.style.strokeWidth=lineWidth;h.style.stroke="#004D8B";h.style.strokeLinecap="round";s.appendChild(h);var ot=n("path"),pt=b[0].toString()+","+b[1].toString(),wt=(b[0]-f[0]*v-f[1]*it).toString()+","+(b[1]-f[1]*v+f[0]*it).toString(),bt=(b[0]-f[0]*v+f[1]*it).toString()+","+(b[1]-f[1]*v-f[0]*it).toString(),kt="M"+pt+" L"+wt+" L"+bt+" Z";ot.setAttributeNS(null,"d",kt);ot.style.fill="#004D8B";s.appendChild(ot);e.appendChild(s)}for(at=new Set(t.query),i=0;i<r.length;i++){if(ut.hasOwnProperty(r[i][0]))rt=ut[r[i][0]];else{for(color=[],k=0,p=Math.random()*120+80,d=0;d<3;d++)color[d]=Math.random(),k+=color[d];rt="#"+Math.round(p*color[0]/k+(255-p)).toString(16)+Math.round(p*color[1]/k+(255-p)).toString(16)+Math.round(p*color[2]/k+(255-p)).toString(16);ut[r[i][0]]=rt}vt="#000000";s=n("g");y=n("circle");y.setAttribute("cx",r[i][1]*u);y.setAttribute("cy",r[i][2]*u);y.setAttribute("r",o);y.style.strokeWidth=1;y.style.stroke="#000000";y.style.fill=rt;yt=Math.max(2.3*o/r[i][0].length,.12*100);w=n("text");w.setAttribute("x",r[i][1]*100);w.setAttribute("y",r[i][2]*u+yt/2);w.style.textAnchor="middle";w.style.fill=vt;w.textContent=r[i][0];at.has(i)&&(c=n("circle"),c.setAttribute("cx",r[i][1]*u),c.setAttribute("cy",r[i][2]*u),c.setAttribute("r",o+5),c.style.stroke="#FFD700",c.style.strokeWidth="10",c.style.fillOpacity="0",c.style.strokeOpacity="0.5",s.appendChild(c));s.appendChild(y);s.appendChild(w);e.appendChild(s)}return g=e.getBBox(),l=[g.x-5,g.y-5,g.width+10,g.height+10],e.setAttribute("viewBox",l.join(" ")),e.setAttribute("width",l[2]+"px"),e.setAttribute("height",l[3]+"px"),[l[2],l[3]]}var e="",t=null,i=null,f;$("#btnref").click(function(){s();var n={refKey:e};$.ajax({type:"GET",url:refURl,data:n,success:function(n){h(n)},error:function(){document.getElementById("outtext").innerHTML="No data found."},complete:function(){document.getElementById("spinner2").classList.add("hidden");document.getElementById("ref").classList.add("hidden")}})});document.getElementById("inputscale").oninput=function(){u();t||o()};document.getElementById("inputscale").onchange=function(){u();t&&o()};$("#btnsave").click(function(){c()});$(window).on("unload",function(){var n=new XMLHttpRequest;n.open("GET",cancelUrl,!0);n.send(instanceID)});f=getRequestParam();f!==null?(l(),$.ajax({type:"GET",url:searchUrl,data:f,success:function(n){var t=a(n);width=t[0];height=t[1];e=n.refKey;document.getElementById("div-scale").classList.remove("hidden")},error:function(){r("No data was found.")},complete:function(){document.getElementById("spinner").classList.add("hidden");document.getElementById("btnsubmit").disabled=!1}})):r("Invalid input.")})();